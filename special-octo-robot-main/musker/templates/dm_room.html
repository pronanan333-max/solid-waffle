{% extends 'base.html' %}

{% block content %}

<h2>Chat with {{ other_user.username }}</h2>

<div id="chat-box" style="border:1px solid #ccc; padding:10px; height:300px; overflow-y:scroll;">
  {% for msg in messages %}
    <p>
      <strong>
        {% if msg.sender == request.user %}
          You
        {% else %}
          {{ msg.sender.username }}
        {% endif %}
      </strong>:
      {{ msg.body }}
    </p>
  {% endfor %}
</div>

<form method="POST">
  {% csrf_token %}
  <textarea name="body" rows="3" required></textarea>
  <br>
  <button type="submit">Send</button>
</form>

<script>
  const chatBox = document.getElementById("chat-box");
  chatBox.scrollTop = chatBox.scrollHeight;
</script>
  <a href="{% url 'delete_chat_room' other_user.id %}"
     style="color:red; font-size:14px; margin-left:10px;"
     onclick="return confirm('Delete entire chat? This cannot be undone.');">
    Delete chat
  </a>

{% endblock %}
